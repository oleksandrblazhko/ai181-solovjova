### Підготувати структури даних для імітації Token-механізму аутентифікації в СУБД PostgreSQL.

`DROP TABLE IF EXISTS sso_tokens;
CREATE TABLE sso_tokens (
		user_id INTEGER,
		token 	VARCHAR,
		FOREIGN KEY (user_id) REFERENCES users(user_id)
);`

![image](https://user-images.githubusercontent.com/56130345/208975140-88741426-1739-43d5-a974-d4d544c54e3c.png)


![image](https://user-images.githubusercontent.com/56130345/208975758-fd01bf27-a80f-412e-aff3-5770d33815fd.png)

`CREATE OR REPLACE PROCEDURE sso_control(
    v_user_name VARCHAR,
	v_token VARCHAR
)
AS $$
BEGIN
	IF NOT EXISTS ( SELECT FROM users u, sso_tokens t
					WHERE lower(u.user_name) = v_user_name 
						AND u.user_id = t.user_id
						AND t.token = v_token
				) THEN
		RAISE EXCEPTION 'Auth Error';
	END IF;
END;
$$ LANGUAGE plpgsql;
`
![image](https://user-images.githubusercontent.com/56130345/208976662-c30d16e8-048c-4409-93d6-27c0631be790.png)
